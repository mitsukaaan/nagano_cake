<h2>ショッピングカート</h2>

<% @total_price = 0 %>
<% @cart_items.each do |cart_item| %>
<%= form_with model:cart_item,url:cart_item_path(cart_item),method: :patch do |f| %>

<h2>商品名</h2>
  <%= cart_item.item.name %>

<h2>単価</h2>
¥<%= cart_item.item.price.to_s(:delimited) %>

<h2>数量</h2>
  <%= f.select :amount,*[1..10],{ include_blank: cart_item.amount}  %><%= f.submit '変更' %>

<h2>小計</h2>
¥<%= (((cart_item.item.price*1.1)*(cart_item.amount)).floor).to_s(:delimited) %>

<%= link_to "削除する",cart_item_path(cart_item),method: :delete,"data-confirm" => "カートから削除します。よろしいですか？" %>
<% @total_price += (cart_item.item.price*1.1)*(cart_item.amount) %>

<% end %>
<% end %>

<h2>合計金額</h2>
¥<%= (@total_price.floor).to_s(:delimited) %>


<%= link_to "カートを空にする",cart_items_destroy_all_path,method: :delete,"data-confirm" => "カートを空にします。本当によろしいですか？" %>
<%= link_to "買い物を続ける",items_path %>